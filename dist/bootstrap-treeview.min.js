(function(a,b,c,d){'use strict';var e='treeview',f={};f.settings={injectStyle:!0,levels:2,expandIcon:'fa fa-plus-square-o',collapseIcon:'fa fa-minus-square-o',emptyIcon:'',nodeIcon:'',selectedIcon:'',checkedIcon:'fa fa-check-square-o',uncheckedIcon:'fa fa-square-o',color:d,backColor:d,borderColor:d,onhoverColor:'#F5F5F5',selectedColor:'#FFFFFF',selectedBackColor:'#428bca',searchResultColor:'#D9534F',searchResultBackColor:d,enableLinks:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showIcon:!0,showCheckbox:!1,showTags:!1,multiSelect:!1,onNodeChecked:d,onNodeCollapsed:d,onNodeDisabled:d,onNodeEnabled:d,onNodeExpanded:d,onNodeSelected:d,onNodeUnchecked:d,onNodeUnselected:d,onSearchComplete:d,onSearchCleared:d},f.options={silent:!1,ignoreChildren:!1},f.searchOptions={ignoreCase:!0,exactMatch:!1,revealResults:!0};var g=function(j,k){return this.$element=a(j),this.elementId=j.id,this.styleId=this.elementId+'-style',this.init(k),{options:this.options,init:a.proxy(this.init,this),remove:a.proxy(this.remove,this),getNode:a.proxy(this.getNode,this),getParent:a.proxy(this.getParent,this),getSiblings:a.proxy(this.getSiblings,this),getSelected:a.proxy(this.getSelected,this),getUnselected:a.proxy(this.getUnselected,this),getExpanded:a.proxy(this.getExpanded,this),getCollapsed:a.proxy(this.getCollapsed,this),getChecked:a.proxy(this.getChecked,this),getUnchecked:a.proxy(this.getUnchecked,this),getDisabled:a.proxy(this.getDisabled,this),getEnabled:a.proxy(this.getEnabled,this),selectNode:a.proxy(this.selectNode,this),unselectNode:a.proxy(this.unselectNode,this),toggleNodeSelected:a.proxy(this.toggleNodeSelected,this),collapseAll:a.proxy(this.collapseAll,this),collapseNode:a.proxy(this.collapseNode,this),expandAll:a.proxy(this.expandAll,this),expandNode:a.proxy(this.expandNode,this),toggleNodeExpanded:a.proxy(this.toggleNodeExpanded,this),revealNode:a.proxy(this.revealNode,this),checkAll:a.proxy(this.checkAll,this),checkNode:a.proxy(this.checkNode,this),uncheckAll:a.proxy(this.uncheckAll,this),uncheckNode:a.proxy(this.uncheckNode,this),toggleNodeChecked:a.proxy(this.toggleNodeChecked,this),disableAll:a.proxy(this.disableAll,this),disableNode:a.proxy(this.disableNode,this),enableAll:a.proxy(this.enableAll,this),enableNode:a.proxy(this.enableNode,this),toggleNodeDisabled:a.proxy(this.toggleNodeDisabled,this),search:a.proxy(this.search,this),clearSearch:a.proxy(this.clearSearch,this)}};g.prototype.init=function(j){this.tree=[],this.nodes=[],j.data&&('string'==typeof j.data&&(j.data=a.parseJSON(j.data)),this.tree=a.extend(!0,[],j.data),delete j.data),this.options=a.extend({},f.settings,j),this.destroy(),this.subscribeEvents(),this.setInitialStates({nodes:this.tree},0),this.render()},g.prototype.remove=function(){this.destroy(),a.removeData(this,e),a('#'+this.styleId).remove()},g.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)},g.prototype.unsubscribeEvents=function(){this.$element.off('click'),this.$element.off('nodeChecked'),this.$element.off('nodeCollapsed'),this.$element.off('nodeDisabled'),this.$element.off('nodeEnabled'),this.$element.off('nodeExpanded'),this.$element.off('nodeSelected'),this.$element.off('nodeUnchecked'),this.$element.off('nodeUnselected'),this.$element.off('searchComplete'),this.$element.off('searchCleared')},g.prototype.subscribeEvents=function(){this.unsubscribeEvents(),this.$element.on('click',a.proxy(this.clickHandler,this)),'function'==typeof this.options.onNodeChecked&&this.$element.on('nodeChecked',this.options.onNodeChecked),'function'==typeof this.options.onNodeCollapsed&&this.$element.on('nodeCollapsed',this.options.onNodeCollapsed),'function'==typeof this.options.onNodeDisabled&&this.$element.on('nodeDisabled',this.options.onNodeDisabled),'function'==typeof this.options.onNodeEnabled&&this.$element.on('nodeEnabled',this.options.onNodeEnabled),'function'==typeof this.options.onNodeExpanded&&this.$element.on('nodeExpanded',this.options.onNodeExpanded),'function'==typeof this.options.onNodeSelected&&this.$element.on('nodeSelected',this.options.onNodeSelected),'function'==typeof this.options.onNodeUnchecked&&this.$element.on('nodeUnchecked',this.options.onNodeUnchecked),'function'==typeof this.options.onNodeUnselected&&this.$element.on('nodeUnselected',this.options.onNodeUnselected),'function'==typeof this.options.onSearchComplete&&this.$element.on('searchComplete',this.options.onSearchComplete),'function'==typeof this.options.onSearchCleared&&this.$element.on('searchCleared',this.options.onSearchCleared)},g.prototype.setInitialStates=function(j,k){if(j.nodes){k+=1;var m=this;a.each(j.nodes,function(p,q){q.nodeId=m.nodes.length,q.parentId=j.nodeId,q.hasOwnProperty('selectable')||(q.selectable=!0),q.state=q.state||{},q.state.hasOwnProperty('checked')||(q.state.checked=!1),q.state.hasOwnProperty('disabled')||(q.state.disabled=!1),q.state.hasOwnProperty('expanded')||(!q.state.disabled&&k<m.options.levels&&q.nodes&&0<q.nodes.length?q.state.expanded=!0:q.state.expanded=!1),q.state.hasOwnProperty('selected')||(q.state.selected=!1),m.nodes.push(q),q.nodes&&m.setInitialStates(q,k)})}},g.prototype.clickHandler=function(j){this.options.enableLinks||j.preventDefault();var k=a(j.target),l=this.findNode(k);if(l&&!l.state.disabled){var m=k.attr('class')?k.attr('class').split(' '):[];-1===m.indexOf('expand-icon')?-1===m.indexOf('check-icon')?-1===m.indexOf('select-all')?-1===m.indexOf('select-none')?(l.selectable?this.toggleSelectedState(l,f.options):this.toggleExpandedState(l,f.options),this.render()):(this.unselectNode(l.nodes),this.render()):(this.selectNode(l.nodes),this.render()):(this.toggleCheckedState(l,f.options),this.render()):(this.toggleExpandedState(l,f.options),this.render())}},g.prototype.findNode=function(j){var k=j.closest('li.list-group-item').attr('data-nodeid'),l=this.nodes[k];return l||console.log('Error: node does not exist'),l},g.prototype.toggleExpandedState=function(j,k){j&&this.setExpandedState(j,!j.state.expanded,k)},g.prototype.setExpandedState=function(j,k,l){k===j.state.expanded||(k&&j.nodes?(j.state.expanded=!0,!l.silent&&this.$element.trigger('nodeExpanded',a.extend(!0,{},j))):!k&&(j.state.expanded=!1,!l.silent&&this.$element.trigger('nodeCollapsed',a.extend(!0,{},j)),j.nodes&&!l.ignoreChildren&&a.each(j.nodes,a.proxy(function(m,o){this.setExpandedState(o,!1,l)},this))))},g.prototype.toggleSelectedState=function(j,k){j&&this.setSelectedState(j,!j.state.selected,k)},g.prototype.setSelectedState=function(j,k,l){k===j.state.selected||(k?(!this.options.multiSelect&&a.each(this.findNodes('true','g','state.selected'),a.proxy(function(m,o){this.setSelectedState(o,!1,l)},this)),j.state.selected=!0,!l.silent&&this.$element.trigger('nodeSelected',a.extend(!0,{},j))):(j.state.selected=!1,!l.silent&&this.$element.trigger('nodeUnselected',a.extend(!0,{},j))))},g.prototype.toggleCheckedState=function(j,k){j&&this.setCheckedState(j,!j.state.checked,k)},g.prototype.setCheckedState=function(j,k,l){k===j.state.checked||(k?(j.state.checked=!0,!l.silent&&this.$element.trigger('nodeChecked',a.extend(!0,{},j))):(j.state.checked=!1,!l.silent&&this.$element.trigger('nodeUnchecked',a.extend(!0,{},j))))},g.prototype.setDisabledState=function(j,k,l){k===j.state.disabled||(k?(j.state.disabled=!0,this.setExpandedState(j,!1,l),this.setSelectedState(j,!1,l),this.setCheckedState(j,!1,l),!l.silent&&this.$element.trigger('nodeDisabled',a.extend(!0,{},j))):(j.state.disabled=!1,!l.silent&&this.$element.trigger('nodeEnabled',a.extend(!0,{},j))))},g.prototype.render=function(){this.initialized||(this.$element.addClass(e),this.$wrapper=a(this.template.list),this.injectStyle(),this.initialized=!0),this.$element.empty().append(this.$wrapper.empty()),this.buildTree(this.tree,0)},g.prototype.buildTree=function(j,k){if(j){k+=1;var l=this;a.each(j,function(o,p){for(var q=a(l.template.item).addClass('node-'+l.elementId).addClass(p.state.checked?'node-checked':'').addClass(p.state.disabled?'node-disabled':'').addClass(p.state.selected?'node-selected':'').addClass(p.searchResult?'search-result':'').attr('data-nodeid',p.nodeId).attr('style',l.buildStyleOverride(p)),r=0;r<k-1;r++)q.append(l.template.indent);var s=[];if(p.nodes?(s.push('expand-icon'),p.state.expanded?s.push(l.options.collapseIcon):s.push(l.options.expandIcon)):s.push(l.options.emptyIcon),q.append(a(l.template.icon).addClass(s.join(' '))),l.options.showIcon){var s=['node-icon'];s.push(p.icon||l.options.nodeIcon),p.state.selected&&(s.pop(),s.push(p.selectedIcon||l.options.selectedIcon||p.icon||l.options.nodeIcon)),q.append(a(l.template.icon).addClass(s.join(' ')))}if(l.options.showCheckbox){var s=['check-icon'];p.state.checked?s.push(l.options.checkedIcon):s.push(l.options.uncheckedIcon),q.append(a(l.template.icon).addClass(s.join(' ')))}if(l.options.enableLinks?q.append(a(l.template.link).attr('href',p.href).append(p.text)):q.append(p.text),l.options.showTags&&p.tags&&a.each(p.tags,function(w,x){q.append(a(l.template.badge).append(x))}),p.state.expanded&&l.options.multiSelect){var t=new Set(p.nodes.map(v=>v.state.selected)),u=1==t.size&&t.has(!0);u?q.append(a(l.template.selectNone)):q.append(a(l.template.selectAll))}return(l.$wrapper.append(q),p.nodes&&p.state.expanded&&!p.state.disabled)?l.buildTree(p.nodes,k):void 0})}},g.prototype.buildStyleOverride=function(j){if(j.state.disabled)return'';var k=j.color,l=j.backColor;return this.options.highlightSelected&&j.state.selected&&(this.options.selectedColor&&(k=this.options.selectedColor),this.options.selectedBackColor&&(l=this.options.selectedBackColor)),this.options.highlightSearchResults&&j.searchResult&&!j.state.disabled&&(this.options.searchResultColor&&(k=this.options.searchResultColor),this.options.searchResultBackColor&&(l=this.options.searchResultBackColor)),'color:'+k+';background-color:'+l+';'},g.prototype.injectStyle=function(){this.options.injectStyle&&!c.getElementById(this.styleId)&&a('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+' </style>').appendTo('head')},g.prototype.buildStyle=function(){var j='.node-'+this.elementId+'{';return this.options.color&&(j+='color:'+this.options.color+';'),this.options.backColor&&(j+='background-color:'+this.options.backColor+';'),this.options.showBorder?this.options.borderColor&&(j+='border:1px solid '+this.options.borderColor+';'):j+='border:none;',j+='}',this.options.onhoverColor&&(j+='.node-'+this.elementId+':not(.node-disabled):hover{background-color:'+this.options.onhoverColor+';}'),this.css+j},g.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>',selectAll:'<a href="#" class="float-right select-all" style="color:inherit;">Select all</a>',selectNone:'<a href="#" class="float-right select-none" style="color:inherit;">Select none</a>'},g.prototype.css='.treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}',g.prototype.getNode=function(j){return this.nodes[j]},g.prototype.getParent=function(j){var k=this.identifyNode(j);return this.nodes[k.parentId]},g.prototype.getSiblings=function(j){var k=this.identifyNode(j),l=this.getParent(k),m=l?l.nodes:this.tree;return m.filter(function(o){return o.nodeId!==k.nodeId})},g.prototype.getSelected=function(){return this.findNodes('true','g','state.selected')},g.prototype.getUnselected=function(){return this.findNodes('false','g','state.selected')},g.prototype.getExpanded=function(){return this.findNodes('true','g','state.expanded')},g.prototype.getCollapsed=function(){return this.findNodes('false','g','state.expanded')},g.prototype.getChecked=function(){return this.findNodes('true','g','state.checked')},g.prototype.getUnchecked=function(){return this.findNodes('false','g','state.checked')},g.prototype.getDisabled=function(){return this.findNodes('true','g','state.disabled')},g.prototype.getEnabled=function(){return this.findNodes('false','g','state.disabled')},g.prototype.selectNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setSelectedState(l,!0,m)},this)),this.render()},g.prototype.unselectNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setSelectedState(l,!1,m)},this)),this.render()},g.prototype.toggleNodeSelected=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.toggleSelectedState(l,m)},this)),this.render()},g.prototype.collapseAll=function(j){var k=this.findNodes('true','g','state.expanded');this.forEachIdentifier(k,j,a.proxy(function(l,m){this.setExpandedState(l,!1,m)},this)),this.render()},g.prototype.collapseNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setExpandedState(l,!1,m)},this)),this.render()},g.prototype.expandAll=function(j){if(j=a.extend({},f.options,j),j&&j.levels)this.expandLevels(this.tree,j.levels,j);else{var k=this.findNodes('false','g','state.expanded');this.forEachIdentifier(k,j,a.proxy(function(l,m){this.setExpandedState(l,!0,m)},this))}this.render()},g.prototype.expandNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setExpandedState(l,!0,m),l.nodes&&m&&m.levels&&this.expandLevels(l.nodes,m.levels-1,m)},this)),this.render()},g.prototype.expandLevels=function(j,k,l){l=a.extend({},f.options,l),a.each(j,a.proxy(function(m,o){this.setExpandedState(o,!!(0<k),l),o.nodes&&this.expandLevels(o.nodes,k-1,l)},this))},g.prototype.revealNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){for(var o=this.getParent(l);o;)this.setExpandedState(o,!0,m),o=this.getParent(o)},this)),this.render()},g.prototype.toggleNodeExpanded=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.toggleExpandedState(l,m)},this)),this.render()},g.prototype.checkAll=function(j){var k=this.findNodes('false','g','state.checked');this.forEachIdentifier(k,j,a.proxy(function(l,m){this.setCheckedState(l,!0,m)},this)),this.render()},g.prototype.checkNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setCheckedState(l,!0,m)},this)),this.render()},g.prototype.uncheckAll=function(j){var k=this.findNodes('true','g','state.checked');this.forEachIdentifier(k,j,a.proxy(function(l,m){this.setCheckedState(l,!1,m)},this)),this.render()},g.prototype.uncheckNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setCheckedState(l,!1,m)},this)),this.render()},g.prototype.toggleNodeChecked=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.toggleCheckedState(l,m)},this)),this.render()},g.prototype.disableAll=function(j){var k=this.findNodes('false','g','state.disabled');this.forEachIdentifier(k,j,a.proxy(function(l,m){this.setDisabledState(l,!0,m)},this)),this.render()},g.prototype.disableNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setDisabledState(l,!0,m)},this)),this.render()},g.prototype.enableAll=function(j){var k=this.findNodes('true','g','state.disabled');this.forEachIdentifier(k,j,a.proxy(function(l,m){this.setDisabledState(l,!1,m)},this)),this.render()},g.prototype.enableNode=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setDisabledState(l,!1,m)},this)),this.render()},g.prototype.toggleNodeDisabled=function(j,k){this.forEachIdentifier(j,k,a.proxy(function(l,m){this.setDisabledState(l,!l.state.disabled,m)},this)),this.render()},g.prototype.forEachIdentifier=function(j,k,l){k=a.extend({},f.options,k),j instanceof Array||(j=[j]),a.each(j,a.proxy(function(m,o){l(this.identifyNode(o),k)},this))},g.prototype.identifyNode=function(j){return'number'==typeof j?this.nodes[j]:j},g.prototype.search=function(j,k){k=a.extend({},f.searchOptions,k),this.clearSearch({render:!1});var l=[];if(j&&0<j.length){k.exactMatch&&(j='^'+j+'$');var m='g';k.ignoreCase&&(m+='i'),l=this.findNodes(j,m),a.each(l,function(o,p){p.searchResult=!0})}return k.revealResults?this.revealNode(l):this.render(),this.$element.trigger('searchComplete',a.extend(!0,{},l)),l},g.prototype.clearSearch=function(j){j=a.extend({},{render:!0},j);var k=a.each(this.findNodes('true','g','searchResult'),function(l,m){m.searchResult=!1});j.render&&this.render(),this.$element.trigger('searchCleared',a.extend(!0,{},k))},g.prototype.findNodes=function(j,k,l){k=k||'g',l=l||'text';var m=this;return a.grep(this.nodes,function(o){var p=m.getNodeValue(o,l);if('string'==typeof p)return p.match(new RegExp(j,k))})},g.prototype.getNodeValue=function(j,k){var l=k.indexOf('.');if(0<l){var m=j[k.substring(0,l)],o=k.substring(l+1,k.length);return this.getNodeValue(m,o)}return j.hasOwnProperty(k)?j[k].toString():d};var h=function(j){b.console&&b.console.error(j)};a.fn[e]=function(j,k){var l;return this.each(function(){var m=a.data(this,e);'string'==typeof j?m?a.isFunction(m[j])&&'_'!==j.charAt(0)?(!(k instanceof Array)&&(k=[k]),l=m[j].apply(m,k)):h('No such method : '+j):h('Not initialized, can not call method : '+j):'boolean'==typeof j?l=m:a.data(this,e,new g(this,a.extend(!0,{},j)))}),l||this}})(jQuery,window,document);
